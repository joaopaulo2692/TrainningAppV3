@page "/trainning"
@inject IDialogService DialogService
@using TrainningApp.Core.DTO.TrainningDay
@using TrainningApp.Core.DTO.TrainningExercise
@using TrainningApp.Core.Entities
@using TrainningAppV3.Client.Components


<h3>Sessões do treino</h3>



<MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6">


    <MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6" @key="_uniqueKey">
        @foreach (var drop in DropzoneList)
        {
            <MudTabPanel Text=@drop[0].Name Key="@drop.GetHashCode()">
                <DropZoneExercises OnAddExercise="HandleAddExercise" T="DropZoneItem" _items="drop" _zones="_zones" />
            </MudTabPanel>
        }
    </MudTabs>

   
</MudTabs>

  
@code {
    private int _uniqueKey = 0;
    public string Exercicio { get; set; }
    public string Serie{ get; set; }
    private int SelectedTabIndex { get; set; }
    public Position Position { get; set; } = Position.Left;


    private async Task HandleAddExercise(TrainningExerciseVO newExercise)
    {
        // // Aqui você pode manipular o novo exercício recebido
        // _items.Add(new DropZoneItem { Zone = "Drop Zone 1", Exercise = newExercise, Name ="A" });
        // // DropzoneList = new List<List<DropZoneItem>>();
        // _items = _items.ToList();
        // DropzoneList.Add(_items);
       
        // await InvokeAsync(StateHasChanged);
        // // StateHasChanged(); // Atualiza a interface se necessário

        _items.Add(new DropZoneItem { Zone = "Drop Zone 1", Exercise = newExercise, Name = "A" });
        DropzoneList = new List<List<DropZoneItem>>(DropzoneList); // Recrie a lista para atualizar o estado
        _uniqueKey++;
        await InvokeAsync(StateHasChanged);
    }


    // List<TrainningDayReturnVO> trainningDayReturnList = new List<TrainningDayReturnVO>();
    List<TrainningExerciseVO> exercises = new List<TrainningExerciseVO>()
    {
        new TrainningExerciseVO()
        {
            Reps = "10",
            Set = 3,
            ExerciseName = "Supino",
            Info = "Normal",
            Ordenation = 1
        },
         new TrainningExerciseVO()
        {
            Reps = "10",
            Set = 3,
            ExerciseName = "Supino reto",
            Info = "Normal",
            Ordenation = 2
        },
         new TrainningExerciseVO()
        {
            Reps = "10",
            Set = 3,
            ExerciseName = "Supino inclinado",
            Info = "Normal",
            Ordenation = 2
        }
    };
    // TrainningExerciseVO trainningExercise = new TrainningExerciseVO()
    //     {
    //         Reps = 10,
    //         Set = 3,
    //         ExerciseName = "Supino"
    //     };



    TrainningDay trainningDay = new TrainningDay();


    // private void ItemUpdated(MudItemDropInfo<DropZoneItem> dropItem) => dropItem.Item.Zone = dropItem.DropzoneIdentifier;

    public List<DropZone> _zones = new()
    {
        new() { Name = "Drop Zone 1" },
        // new() { Name = "Drop Zone 2" }
    };

    public List<DropZoneItem> _items = new()
    {
        // new() { Zone = "Drop Zone 1", Name = "Item 1" },
        // new() { Zone = "Drop Zone 1", Name = "Item 2" },
        // new() { Zone = "Drop Zone 2", Name = "Item 3" },

    };

    public List<DropZoneItem> _items2 = new()
    {
        // new() { Zone = "Drop Zone 1", Name = "Item 1" },
        // new() { Zone = "Drop Zone 1", Name = "Item 2" },
        // new() { Zone = "Drop Zone 2", Name = "Item 3" },

    };

    public class DropZone
    {
        public string Name { get; init; }

    }

    public class DropZoneItem
    {
        public string Zone { get; set; }
        public string Name { get; init; }
        public TrainningExerciseVO Exercise { get; set; }
        public TrainningDayReturnVO TrainningDayReturn { get; set; }
    }
    private List<List<DropZoneItem>> DropzoneList = new List<List<DropZoneItem>>();

    protected override void OnParametersSet()
    {
        StateHasChanged(); // Força atualização ao receber novos parâmetros
    }
    

    protected override void OnInitialized()
    {
        StateHasChanged();

        _items = new List<DropZoneItem>
        {
            new() { Zone = "Drop Zone 1", Name = "A", Exercise =    new TrainningExerciseVO()
        {
            Reps = "10",
            Set = 3,
            ExerciseName = "Supino inclinado",
            Info = "Normal",
            Ordenation = 2
        } },
            new() { Zone = "Drop Zone 1",Name = "A", Exercise =  new TrainningExerciseVO()
        {
            Reps = "10",
            Set = 3,
            ExerciseName = "Supino reto",
            Info = "Normal",
            Ordenation = 2
        } },
            new() { Zone = "Drop Zone 1",Name = "A", Exercise =  new TrainningExerciseVO()
        {
            Reps = "10",
            Set = 3,
            ExerciseName = "Supino",
            Info = "Normal",
            Ordenation = 1
        } }
        };

        _items2 = new List<DropZoneItem>
        {

            new() { Zone = "Drop Zone 1", Name = "B", Exercise =  new TrainningExerciseVO()
        {
            Reps = "10",
            Set = 3,
            ExerciseName = "Supino reto",
            Info = "Normal",
            Ordenation = 2
        } },
            new() { Zone = "Drop Zone 1", Name = "B", Exercise =  new TrainningExerciseVO()
        {
            Reps = "10",
            Set = 3,
            ExerciseName = "Supino",
            Info = "Normal",
            Ordenation = 1
        } }
        };

        DropzoneList.Add(_items);
        DropzoneList.Add(_items2);
    }

    List<TrainningDayReturnVO> trainningDayReturnList = new List<TrainningDayReturnVO>()
    {
        new TrainningDayReturnVO()
        {
            Name = "A",
            TrainningExercises = new List<TrainningExerciseVO>()
            {
                new TrainningExerciseVO()
                {
                Reps = "10",
                Set = 3,
                ExerciseName = "Supino",
                Info = "Normal",
                Ordenation = 1,
                Weight = "60",
                Interval = 30

                },
                 new TrainningExerciseVO()
                {
                Reps = "10",
                Set = 3,
                ExerciseName = "Supino Inclinado",
                Info = "Normal",
                Ordenation = 2,
                Weight = "60",
                Interval = 30
                },
                 new TrainningExerciseVO()
                {
                Reps = "10",
                Set = 3,
                ExerciseName = "Supino Declinado",
                Info = "Normal",
                Ordenation = 3,
                Weight = "60",
                Interval = 30
                },
            }

        },

        new TrainningDayReturnVO()
        {
            Name = "B",
            TrainningExercises = new List<TrainningExerciseVO>()
            {
                new TrainningExerciseVO()
                {
                Reps = "10",
                Set = 3,
                ExerciseName = "Leg",
                Info = "Normal",
                Ordenation = 1,
                Weight = "60",
                Interval = 30

                },
                 new TrainningExerciseVO()
                {
                Reps = "10",
                Set = 3,
                ExerciseName = "Cadeira extensora",
                Info = "Normal",
                Ordenation = 2,
                Weight = "60",
                Interval = 30
                },
                 new TrainningExerciseVO()
                {
                Reps = "10",
                Set = 3,
                ExerciseName = "Panturrilha",
                Info = "Normal",
                Ordenation = 3,
                Weight = "60",
                Interval = 30
                },
            }

        },
        new TrainningDayReturnVO()
        {
            Name = "C",
            TrainningExercises = new List<TrainningExerciseVO>()
            {
                new TrainningExerciseVO()
                {
                Reps = "10",
                Set = 3,
                ExerciseName = "Pulley",
                Info = "Normal",
                Ordenation = 1,
                Weight = "60",
                Interval = 30

                },
                 new TrainningExerciseVO()
                {
                Reps = "10",
                Set = 3,
                ExerciseName = "Encolhimento",
                Info = "Normal",
                Ordenation = 2,
                Weight = "60",
                Interval = 30
                },
                 new TrainningExerciseVO()
                {
                Reps = "10",
                Set = 3,
                ExerciseName = "Abd",
                Info = "Normal",
                Ordenation = 3,
                Weight = "60",
                Interval = 30
                },
            }

        }
    };


   

}
